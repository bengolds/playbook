<link rel="import" href="../bower_components/paper-slider/paper-slider.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/iron-icons/av-icons.html">
<link rel="import" href="range-end-picker.html">
<link rel="import" href="shared-styles.html">
<link rel="import" href="mathObjects/math-objects-import.html">

<dom-module id="slider-scrubber">
  <template>
    <style include="shared-styles"></style>
    <style>
      :host {
        display: flex;
        justify-content: center;
        padding: 0px 24px;
        margin: auto;
        margin-top: 4px;
      }
      paper-slider {
        flex-grow: 1;
      }
      #bottomTray {
        position: absolute;
        bottom: 8px;
        margin: auto;
      }
    </style>

    <range-end-picker id='lowerBound' on-change='lowerBoundChanged'></range-end-picker>
    <paper-slider id='slider' pin
      immediate-value='{{value}}'
      min='[[getLowerBound(bounds.*)]]'
      max='[[getUpperBound(bounds.*)]]'
      max-markers='20'
      ></paper-slider>
    <range-end-picker id='upperBound' on-change='upperBoundChanged'></range-end-picker>
    <div id='bottomTray'>
      <paper-icon-button icon="add"></paper-icon-button>
      <paper-icon-button icon="av:play-circle-filled"></paper-icon-button>
    </div>
    
  </template>
  <script>
    Polymer({
      is: 'slider-scrubber',
      properties: {
        domain: {
          type: Number,
          notify: false,
          value: SETS.REAL,
          observer: 'domainChanged'
        },
        value: {
          type: Number,
          notify: true,
          value: 0,
        },
        bounds: {
          type: Array,
          notify: true,
          value: [-1, 1],
          observer: 'boundsChanged'
        },
      },

      attached: function() {
        if (this.domain == SETS.NATURAL) {
          this.bounds = [0, this.bounds[1]];
        }
        this.$.slider.value = this.value;
      },

      domainChanged: function () {
        switch (this.domain) {
        case SETS.NATURAL:
          if (this.bounds) {
            this.bounds = [0, this.bounds[1]];
          }
          this.$.slider.step = 1;
          this.$.slider.snaps = true;
          this.$.lowerBound.fixed = true;
          break;

        case SETS.INTEGER:
          this.$.slider.step = 1;
          this.$.slider.snaps = true;
          this.$.lowerBound.fixed = false;
          break;

        case SETS.REAL:
          this.$.slider.step = 0.01;
          this.$.slider.snaps = false;
          this.$.lowerBound.fixed = false;
          break;
        }
      },

      getLowerBound: function () {
        return this.bounds[0];
      },

      getUpperBound: function () {
        return this.bounds[1];
      },

      lowerBoundChanged: function() {
        this.set('bounds.0', this.$.lowerBound.value);
      },

      upperBoundChanged: function() {
        this.set('bounds.1', this.$.upperBound.value);
      },

      boundsChanged: function () {
        this.$.lowerBound.value = this.bounds[0];
        this.$.upperBound.value = this.bounds[1];
      },
      
    });
  </script>
</dom-module>