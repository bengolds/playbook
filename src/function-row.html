<link rel="import" href="mathbox-plot.html">
<link rel="import" href="function-input.html">
<link rel="import" href="function-parser.html">
<link rel="import" href="function-signature.html">

<dom-module id="function-row">
  <template>
    <style>
      :host {
        display: flex;
        flex-wrap: nowrap;
        align-items: center;
        height:192px;
      }
      #plot {
        flex-basis: 480px;
      }
    </style>
    <function-signature text="[[signature]]"></function-signature>
    <function-input on-edit="mathquillChanged"></function-input>
    <mathbox-plot func="[[functor]]" id="plot" animated='true'></mathbox-plot>
    <function-parser id='parser'></function-parser>
  </template>

  <script>
    Polymer({
      is: 'function-row',
      mathquillChanged: function(e) {
        var parser = this.$.parser;
        //TODO: put in try/catch block
        var functionString = e.detail.mathField.semanticText();
        if (parser.isParseable(functionString)) {
          this.signature = parser.getSignature(functionString);
          this.functor = parser.getFunctor(functionString);
        }
      },
    });
 </script>
</dom-module>